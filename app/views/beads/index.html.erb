<%#Creating a simple search
# https://medium.com/le-wagon/build-a-simple-search-with-the-simple-form-gem-in-rails-5-b247168282d1 %>

<% @colors = Bead.color_counts.pluck(:name).uniq.sort_by!{|e| e.downcase}%>
<%= simple_form_for :search, required: false, url: root_path, method: "GET", remote: true do |f| %>
  <div class="form-label" >Colors</div>
  <%= f.input :colors, label: false,  collection: @colors, as: :check_boxes %>
  <%= link_to "Reset", root_path, class: "btn button" %>
<% end %>

<div class = "bead-list">
  <%= render 'bead', beads: @beads %>
  <div class = "bead">
    <%= link_to("Add\n New\n Bead", new_bead_path, \
             id: "add-bead" ) %>
  </div>
  <div class = "bead-placeholder"></div>
  <div class = "bead-placeholder"></div>
  <div class = "bead-placeholder"></div>
</div>

<script type="text/javascript">
  var checkBoxes = document.getElementsByClassName("checkbox");
  var form = document.querySelector('form');

  for (const check of checkBoxes) {
  check.addEventListener( 'change', function() {
    Rails.fire(form, 'submit');
  });
  }
</script>
